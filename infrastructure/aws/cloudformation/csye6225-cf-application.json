		{
			"AWSTemplateFormatVersion": "2010-09-09",
			"Description": "Cloud Formation Template - CSYE6225 - Creating EC2 instance , Security Groups and Ingress Rules",
			"Parameters": {
				"EC2Name": {
					"Type": "String"
				},
				"EC2SecurityGroup": {
					"Type": "String"
				},
				"SubnetId1":{
					"Type":"String"
				},
				"VpcId":{
					"Type":"String"
				},
				"EC2VolumeSize":{
					"Type":"String"
				},
				"EC2VolumeType":{
					"Type":"String"
				},
				"AMIImage":{
					"Type":"String"
				},
				"DynamoDBName":{
					"Type":"String"
				},
				"BucketName":{
					"Type":"String"
				},
				"MasterUsername":{
					"Type":"String"
				},
				"MasterUserPwd":{
					"Type":"String"
				},
				"DBName":{
					"Type":"String"
				},
				"DBInstanceClass":{
					"Type":"String"
				},
				"DBInstanceIdentifier":{
					"Type":"String"
				},
				"DBEngine":{
					"Type":"String"
				}
			},
			"Resources": {
				"ourEC2Instance": {
					"Type": "AWS::EC2::Instance",
					"Properties": {
						"InstanceType": "t2.micro",
						"DisableApiTermination": true,
						"ImageId" : {
							"Ref":"AMIImage"
						},
						"BlockDeviceMappings" : [
							{
								"DeviceName" : "/dev/sda1",
								"Ebs" : {
									"VolumeSize" : {
										"Ref":"EC2VolumeSize"
									},
									"VolumeType" : {
										"Ref":"EC2VolumeType"
									}
								}
							}
						],
						"Tags" : [
							{
								"Key" : "Name",
								"Value" : "app-csye6225-ec2"
							}
						],
						"SecurityGroupIds" : [{
							"Ref" : "EC2SecurityGroup"

						}],
						"SubnetId" : {
							"Ref":"SubnetId1"
						}
					}
				},
				"WebServerSecurityGroup" : {
					"Type" : "AWS::EC2::SecurityGroup",
					"Properties" : {
						"GroupName" : "csye6225-webapp",
						"GroupDescription" : "Access to ports 22, 80 & 443",
						"VpcId": {"Ref":"VpcId"},
						"SecurityGroupIngress" : [ {
							"IpProtocol" : "tcp",
							"FromPort" : "22",
							"ToPort" : "22",
						"CidrIp" : "0.0.0.0/0" },
						{
							"IpProtocol" : "tcp",
							"FromPort" : "80",
							"ToPort" : "80",
						"CidrIp" : "0.0.0.0/0" },
						{
							"IpProtocol" : "tcp",
							"FromPort" : "443",
							"ToPort" : "443",
							"CidrIp" : "0.0.0.0/0"
						} ]
					}
				},
				"DBEC2SecurityGroup": {
					"Type": "AWS::EC2::SecurityGroup",
					"Properties" : {
						"GroupName": "csye6225-rds",
						"GroupDescription": "Open database for access",
						"SecurityGroupIngress" : [{
							"IpProtocol" : "tcp",
							"FromPort" : "3306",
							"ToPort" : "3306",
							"SourceSecurityGroupId" : { "Ref" : "EC2SecurityGroup" }
						}],
						"VpcId": {"Ref":"VpcId"}
					}

				},
				"ourDynamoTable": {
					"Type" : "AWS::DynamoDB::Table",
					"Properties" : {
						"KeySchema": [
							{
								"AttributeName": "id",
								"KeyType": "HASH"
							}
						],
						"AttributeDefinitions": [
							{
								"AttributeName": "id",
								"AttributeType": "S"
							}
						],
						"TableName": {
							"Ref": "DynamoDBName"
						},
						"ProvisionedThroughput":{
							"ReadCapacityUnits": "5",
							"WriteCapacityUnits": "5"
						}
					}
				},
				"ourS3Bucket":{
					"Type" : "AWS::S3::Bucket",
					"Properties" : {
						"BucketName":{
							"Ref":"BucketName"
						},
						"Description":"S3 Bucket to store attachment files",
						"AccessControl" : "Private"
					}

				},
				"myRDSDBSubnet": {
					"Type": "AWS::RDS::DBSubnetGroup",
					"Properties": {
						"DBSubnetGroupDescription": "Subnet Group fro RDS Instance",
						"SubnetIds": [
							{
								"Ref": "SubnetId2"
							},
							{
								"Ref": "SubnetId3"
							}
						]
					}
				},
				"ourRDSInstance":
				{
					"Type" : "AWS::RDS::DBInstance",
					"Properties" :
					{
						"MasterUsername" : {
							"Ref":"MasterUsername"
						},
						"MasterUserPassword" : {
							"Ref":"MasterUserPwd"
						},
						"MultiAZ" : false,
						"PubliclyAccessible" : false,
						"DBName": {
							"Ref": "DBName"
						},
						"DBInstanceClass": {
							"Ref": "DBInstanceClass"
						},
						"DBInstanceIdentifier": {
							"Ref": "DBInstanceIdentifier"
						},
						"Engine": {
							"Ref": "DBEngine"
						},
						"DBSubnetGroupName": {
							"Ref": "myRDSDBSubnet"
						},
						"VPCSecurityGroups": [
							{
								"Ref": "RDSSecurityGroup"
							}
						]
					}
				}
			}
